/**
* vue-app-scroller v1.0.5
* https://github.com/JooZh/vue-app-scroller
* Released under the MIT License.
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.VueAppScroller=t()}(this,function(){"use strict";var t,d,g,o,Y,n=(t=window,d=Date.now||function(){return+new Date},g={},o=1,Y={requestAnimationFrame:function(e){(t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame)(e)},stop:function(e){var t=null!=g[e];return t&&(g[e]=null),t},isRunning:function(e){return null!=g[e]},start:function(c,a,s,u,_){var h=d(),p=h,f=0,m=0,v=o++;if(v%20==0){var e={};for(var t in g)e[t]=!0;g=e}return g[v]=!0,Y.requestAnimationFrame(function e(t){var o=!0!==t,n=d();if(!g[v]||a&&!a(v))return g[v]=null,void(s&&s(60-m/((n-h)/1e3),v,!1));if(o)for(var r=Math.round((n-p)/(1e3/60))-1,l=0;l<Math.min(r,4);l++)e(!0),m++;u&&1<(f=(n-h)/u)&&(f=1);var i=_?_(f):f;!1!==c(i,n,o)&&1!==f||!o?o&&(p=n,Y.requestAnimationFrame(e)):(g[v]=null,s&&s(60-m/((n-h)/1e3),v,1===f||null==u))}),v}});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function r(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var o=this;for(var n in o.w=window,o._NOOP=function(){},o._handles={scroll:[],loading:[]},o.ops={listenScroll:!1,isPullRefresh:!1,isReachBottom:!1,scrollingX:!1,scrollingY:!1,animating:!0,animationDuration:250,mousewheel:!1,paging:!1,snap:!1,snapAlign:"top",snapSelect:0,snapListIndex:0,bouncing:!0,speedRatio:1,scrollingComplete:o._NOOP,snapComplete:o._NOOP,peneDece:.07,peneAcce:.08},t)o.ops[n]=t[n];o._initPublicApi(),o._initAttr(e),o._initSnapSize(o.ops.snap),o._initEvent()}return function(e,t,o){return t&&r(e.prototype,t),o&&r(e,o),e}(i,[{key:"_initSelector",value:function(e){var r=this,t=null;"string"==typeof e?t=document.querySelector(e):"object"===(void 0===e?"undefined":l(e))&&1===e.nodeType&&(t=e);var o=r.w.MutationObserver||r.w.WebKitMutationObserver||r.w.MozMutationObserver;return o&&new o(function(e){var n=e.length-1;e.forEach(function(e,t){if(r.ops.snap)r.refresh();else if(n===t)var o=setTimeout(function(){r.refresh(),clearTimeout(o)},30)})}).observe(t.children[1],{childList:!0,subtree:!0}),t}},{key:"_initAttr",value:function(e){var t=this,o=t._initSelector(e);t._render=function(o){var e=window,t=document.documentElement.style,n=void 0;e.opera&&"[object Opera]"===Object.prototype.toString.call(opera)?n="presto":"MozAppearance"in t?n="gecko":"WebkitAppearance"in t?n="webkit":"string"==typeof navigator.cpuClass&&(n="trident");var r={trident:"ms",gecko:"Moz",webkit:"Webkit",presto:"O"}[n],l=document.createElement("div"),i=r+"Perspective",c=r+"Transform";return void 0!==l.style[i]?function(e,t){o.style[c]="translate3d("+-e+"px,"+-t+"px,0)"}:void 0!==l.style[c]?function(e,t){o.style[c]="translate("+-e+"px,"+-t+"px)"}:function(e,t){o.style.marginLeft=e?-e+"px":"",o.style.marginTop=t?-t+"px":""}}(o),t._content=o,t._container=o.parentNode,t._animate=n,t.scrollDirection="",t._isTracking=!1,t.completeDeceleration=!1,t._isDragging=!1,t._isDecelerating=!1,t._isAnimating=!1,t.enableScrollX=!1,t.enableScrollY=!1,t._refreshActive=!1,t._reachActive=!1,t.snapAlignInit=!1,t._interrupted=!0,t._refreshStartCb=null,t._refreshCancelCb=null,t._refreshActiveCb=null,t.scrollX=0,t.scrollY=0,t.minScrollX=0,t.minScrollY=0,t.maxScrollX=0,t.maxScrollY=0,t._prevScrollX=0,t._prevScrollY=0,t._scheduledX=0,t._scheduledY=0,t._lastTouchX=0,t._lastTouchY=0,t._lastTouchT=null,t._velocityX=0,t._velocityY=0,t._refreshH=0,t._loadingH=0,t._contentW=0,t._contentH=0,t._containerW=0,t._containerH=0,t._snapW=50,t._snapH=50,t._minDeceX=0,t._minDeceY=0,t._maxDeceX=0,t._maxDeceY=0,t._touchArr=null}},{key:"_initEvent",value:function(){var t=this,e=t._container,o=window.Modernizr&&!!window.Modernizr.touch||!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch),n={start:o?"touchstart":"mousedown",move:o?"touchmove":"mousemove",end:o?"touchend":"mouseup"};e.addEventListener(n.start,function(e){e.target.tagName.match(/input|textarea|select/i)||(e.preventDefault(),t.doTouchStart(e.touches,e.timeStamp))},!1),e.addEventListener(n.move,function(e){e.preventDefault(),t.doTouchMove(e.touches,e.timeStamp)},!1),e.addEventListener(n.end,function(e){t.doTouchEnd(e.timeStamp)},!1),t.ops.mousewheel&&e.addEventListener("mousewheel",function(e){t.scrollY=t.scrollY+=e.deltaY,t.scrollY>t.maxScrollY&&(t.scrollY=t.maxScrollY),t.scrollY<0&&(t.scrollY=0),t._publish(t.scrollX,t.scrollY,!0)},!1)}},{key:"_initSnapSize",value:function(e){"number"==typeof e?(this._snapW=e,this._snapH=e):Array.isArray(e)&&(this._snapW=e[0],this._snapH=e[1])}},{key:"_setDimensions",value:function(){var e=this;e._containerW=e._container.offsetWidth,e._containerH=e._container.offsetHeight,e._contentW=e._content.offsetWidth,e._contentH=e._content.offsetHeight,e._contentW>e._containerW&&e.ops.scrollingX&&(e.enableScrollX=e.ops.scrollingX),e._contentH>e._containerH&&e.ops.scrollingY&&(e.enableScrollY=e.ops.scrollingY),e.maxScrollY;var t=e._content.children;if(e._refreshH=e.ops.isPullRefresh?t[0].offsetHeight:0,e._loadingH=e.ops.isReachBottom?t[t.length-1].offsetHeight:0,"middle"===e.ops.snapAlign){var o=Math.floor(Math.round(e._containerH/e._snapH)/2);e._content.style.padding=o*e._snapH+"px 0",e.snapAlignInit||(e.scrollY=e.minScrollY+e.ops.snapSelect*e._snapH,e.snapAlignInit=!0)}e.maxScrollX=Math.max(e._contentW-e._containerW,0),e.maxScrollY=Math.max(e._contentH-e._containerH,0)-e._refreshH,e._reachActive=!1,e._scrollTo(e.scrollX,e.scrollY,!0)}},{key:"_initPublicApi",value:function(){var e=function(n){return{refresh:function(){n._setDimensions()},publish:function(e,t,o){n._publish(e,t,o)},scrollTo:function(e,t,o){n._scrollTo(e,t,o)},scrollBy:function(e,t,o){n._scrollBy(e,t,o)},stopScroll:function(){n._stopScroll()},getAttr:function(e){if(-1!==["scrollDirection","enableScrollX","enableScrollY","minScrollX","minScrollY","maxScrollX","maxScrollY"].indexOf(e))return n[e];throw new Error('can not get attr name "key" ')},setAttr:function(e,t){if(-1===["enableScrollX","enableScrollY"].indexOf(e))throw new Error('can not set attr name "key" ');n[e]=t}}}(this);for(var t in e)this[t]=e[t]}},{key:"_easeOutCubic",value:function(e){return Math.pow(e-1,3)+1}},{key:"_easeInOutCubic",value:function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)}},{key:"doTouchStart",value:function(e,t){var o=this;o._isTouches(e),o._isTouchesTime(t),o._isTracking=!0,o.stopScroll(),o._lastTouchX=e[0].pageX,o._lastTouchY=e[0].pageY,o._lastTouchT=t}},{key:"doTouchMove",value:function(e,t){var o=this;if(o._isTouches(e),o._isTouchesTime(t),o._isTracking){var n=e[0].pageX,r=e[0].pageY;if(o._doTouchMoveDirection(n,r),o._isDragging){var l=n-o._lastTouchX,i=r-o._lastTouchY;o.enableScrollX&&o._doTouchMoveActive(l,"X"),o.enableScrollY&&o._doTouchMoveActive(i,"Y"),60<o._touchArr.length&&o._touchArr.splice(0,30),o._touchArr.push(o.scrollX,o.scrollY,t),o._publish(o.scrollX,o.scrollY)}else{var c=Math.abs(n-o._lastTouchX),a=Math.abs(r-o._lastTouchY);o._isDragging=5<=c||5<=a,o._isDragging&&(o._interrupted=!1)}o._lastTouchX=n,o._lastTouchY=r,o._lastTouchT=t}}},{key:"doTouchEnd",value:function(e){var t=this;t._isTouchesTime(e),t._isTracking&&(t._isTracking=!1,t._isDragging&&(t._isDragging=!1,t.ops.animating&&e-t._lastTouchT<=100?t._doTouchCanDeceleration()?t._refreshActive||t._startDeceleration(e):t._scrollingComplete():100<e-t._lastTouchT&&t._scrollingComplete()),t._isDecelerating||(t._refreshActive&&t._refreshStartCb?(t._publish(t.scrollX,-t._refreshH,!0),t._refreshStartCb&&t._refreshStartCb()):((t._interrupted||t._isDragging)&&t._scrollingComplete(),100<e-t._lastTouchT?(t._scrollTo(t.scrollX,t.scrollY,!0),t._getScrollToValues()):t._startDeceleration(),t._refreshActive&&(t._refreshActive=!1,t._refreshCancelCb&&t._refreshCancelCb()))),t._touchArr.length=0)}},{key:"_isTouches",value:function(e){if(null==e.length)throw new Error("Invalid touch list: "+e)}},{key:"_isTouchesTime",value:function(e){if(e instanceof Date&&(e=e.valueOf()),"number"!=typeof e)throw new Error("Invalid timestamp value: "+e)}},{key:"_doTouchMoveActive",value:function(e,t){var o=this,n="scroll"+t,r="maxScroll"+t;o[n]-=e*o.ops.speedRatio,(o[n]>o[r]||o[n]<0)&&(o.ops.bouncing?(o[n]+=e/1.5*o.ops.speedRatio,"Y"===t&&o._doTouchMovePullRefresh()):o[n]>o[r]?o[n]=o[r]:o[n]=0)}},{key:"_doTouchMovePullRefresh",value:function(){var e=this;e.enableScrollX||null==e._refreshH||(!e._refreshActive&&e.scrollY<=-e._refreshH?(e._refreshActive=!0,e._refreshActiveCb&&e._refreshActiveCb()):e._refreshActive&&e.scrollY>-e._refreshH&&(e._refreshActive=!1,e._refreshCancelCb&&e._refreshCancelCb()))}},{key:"_doTouchMoveDirection",value:function(e,t){var o=this,n=e-o._lastTouchX,r=t-o._lastTouchY;0<n&&Math.abs(n)>Math.abs(r)?o.scrollDirection="right":n<0&&Math.abs(n)>Math.abs(r)?o.scrollDirection="left":0<r&&Math.abs(r)>Math.abs(n)?o.scrollDirection="down":r<0&&Math.abs(r)>Math.abs(n)&&(o.scrollDirection="up")}},{key:"_doTouchCanDeceleration",value:function(){for(var e=this,t=!1,o=e._touchArr.length-1,n=o,r=o;0<r&&e._touchArr[r]>e._lastTouchT-100;r-=3)n=r;if(n!==o){var l=e._touchArr[o]-e._touchArr[n],i=e.scrollX-e._touchArr[n-2],c=e.scrollY-e._touchArr[n-1];e._velocityX=i/l*(1e3/60),e._velocityY=c/l*(1e3/60);var a=e.ops.paging||e.ops.snap?4:1,s=Math.abs(e._velocityX)>a,u=Math.abs(e._velocityY)>a;(s||u)&&(t=!0)}return t}},{key:"activatePullToRefresh",value:function(e,t,o){this._refreshStartCb=o,this._refreshActiveCb=e,this._refreshCancelCb=t}},{key:"finishPullToRefresh",value:function(){var e=this;e._refreshActive=!1,e._refreshCancelCb&&e._refreshCancelCb(),e._scrollTo(e.scrollX,e.scrollY,!0)}},{key:"on",value:function(e,t){if(this._handles.hasOwnProperty(e)||(this._handles[e]=[]),"function"!=typeof t)throw new Error("Missing callback function");this._handles[e].push(t)}},{key:"emit",value:function(e){for(var t=arguments.length,n=Array(1<t?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(!this._handles.hasOwnProperty(e))throw new Error('"'+e+'"Event not registered');this._handles[e].forEach(function(e,t,o){e.apply(null,n)})}},{key:"_stopScroll",value:function(){var e=this;e._interrupted=!0,e._isDecelerating&&(e._animate.stop(e._isDecelerating),e._isDecelerating=!1,e._interrupted=!0),e._isAnimating&&(e._animate.stop(e._isAnimating),e._isAnimating=!1,e._interrupted=!0),e.completeDeceleration=!1,e._touchArr=[]}},{key:"_scrollTo",value:function(e,t,o){var n=this;n._isDecelerating&&(n._animate.stop(n._isDecelerating),n._isDecelerating=!1),n.ops.scrollingX?n.ops.paging?e=Math.round(e/n._containerW)*n._containerW:n.ops.snap&&(e=Math.round(e/n._snapW)*n._snapW):e=n.scrollX,n.ops.scrollingY?n.ops.paging?t=Math.round(t/n._containerH)*n._containerH:n.ops.snap&&(t=Math.round(t/n._snapH)*n._snapH):t=n.scrollY,e=Math.max(Math.min(n.maxScrollX,e),0),t=Math.max(Math.min(n.maxScrollY,t),0),e===n.scrollX&&t===n.scrollY&&(o=!1),n._isTracking||n._publish(e,t,o)}},{key:"_scrollToElement",value:function(e,t,o){}},{key:"_scrollBy",value:function(e,t,o){var n=this,r=n._isAnimating?n._scheduledX:n.scrollX,l=n._isAnimating?n._scheduledY:n.scrollY;n._scrollTo(r+(e||0),l+(t||0),o)}},{key:"_publish",value:function(e,t,o){var n=this,r=n._isAnimating;if(r&&(n._animate.stop(r),n._isAnimating=!1,n._interrupted=!0),o&&n.ops.animating){n._scheduledX=e,n._scheduledY=t;var l=n.scrollX,i=n.scrollY,c=e-l,a=t-i,s=r?n._easeOutCubic:n._easeInOutCubic;n._isAnimating=n._animate.start(function(e,t,o){o&&(n.scrollX=l+c*e,n.scrollY=i+a*e,n._render&&n._render(n.scrollX,n.scrollY))},function(e){return n._isAnimating===e},function(e,t,o){t===n._isAnimating&&(n._isAnimating=!1),(n.completeDeceleration||o)&&(n._scrollingComplete(),n._snapComplete())},n.ops.animationDuration,s)}else n._scheduledX=n.scrollX=e,n._scheduledY=n.scrollY=t,n._render&&n._render(e,t);if(n.ops.isReachBottom&&!n._reachActive){var u=Number(n.scrollY.toFixed()),_=n.maxScrollY-n._loadingH;_<u&&0<_&&(n.emit("loading",{hasMore:!0}),n._reachActive=!0)}if(n.ops.listenScroll){var h=n._prevScrollX.toFixed()!==n.scrollX.toFixed(),p=n._prevScrollY.toFixed()!==n.scrollY.toFixed();(h||p)&&n.emit("scroll",{x:Math.floor(n.scrollX),y:Math.floor(n.scrollY)})}}},{key:"_scrollingComplete",value:function(){this.ops.scrollingComplete()}},{key:"_snapComplete",value:function(){"middle"===this.ops.snapAlign&&this.ops.snapComplete(this._getSnapValue())}},{key:"_getSnapValue",value:function(){var e=this,t=Math.abs(e.minScrollY),o=(e.scrollY<0?t-Math.abs(e.scrollY):t+Math.abs(e.scrollY))/e._snapH;return{listIndex:e.ops.snapListIndex,selectIndex:Math.floor(o)}}},{key:"_getScrollToValues",value:function(){var n=this,r=setInterval(function(){var e=n._prevScrollX.toFixed()!==n.scrollX.toFixed(),t=n._prevScrollY.toFixed()!==n.scrollY.toFixed();if(e||t)n.emit("scroll",{x:Math.floor(n.scrollX),y:Math.floor(n.scrollY)});else var o=setTimeout(function(){var e=n.scrollX,t=n.scrollY;0===n.scrollY&&(t=0),0===n.scrollX&&(e=0),n.scrollY===n.maxScrollY&&(t=n.maxScrollY),n.scrollX===n.maxScrollX&&(e=n.maxScrollX),n.emit("scroll",{x:Math.floor(e),y:Math.floor(t)}),clearInterval(r),clearTimeout(o)},50)},30)}},{key:"_startDeceleration",value:function(){var n=this;if(n.ops.paging){var e=Math.max(Math.min(n.scrollX,n.maxScrollX),0),t=Math.max(Math.min(n.scrollY,n.maxScrollY),0);n._minDeceX=Math.floor(e/n._containerW)*n._containerW,n._minDeceY=Math.floor(t/n._containerH)*n._containerH,n._maxDeceX=Math.ceil(e/n._containerW)*n._containerW,n._maxDeceY=Math.ceil(t/n._containerH)*n._containerH}else n._minDeceX=0,n._minDeceY=0,n._maxDeceX=n.maxScrollX,n._maxDeceY=n.maxScrollY;var o=n.ops.snap?2:.001;n._isDecelerating=n._animate.start(function(e,t,o){n._stepThroughDeceleration(o)},function(){var e=Math.abs(n._velocityX)>=o||Math.abs(n._velocityY)>=o;return e||(n.completeDeceleration=!0),e},function(e,t,o){n._isDecelerating=!1,n.completeDeceleration&&n._scrollingComplete(),n._scrollTo(n.scrollX,n.scrollY,n.ops.snap)})}},{key:"_stepThroughDeceleration",value:function(e){var t=this,o=t.scrollX+t._velocityX,n=t.scrollY+t._velocityY;if(!t.ops.bouncing){var r=Math.max(Math.min(t._maxDeceX,o),t._minDeceX);r!==o&&(o=r,t._velocityX=0);var l=Math.max(Math.min(t._maxDeceY,n),t._minDeceY);l!==n&&(n=l,t._velocityY=0)}if(t._prevScrollX=t.scrollX,t._prevScrollY=t.scrollY,e?t._publish(o,n):(t.scrollX=o,t.scrollY=n),t.ops.paging||(t._velocityX*=.97,t._velocityY*=.97),t.ops.bouncing){var i=0,c=0,a=t.ops.peneDece,s=t.ops.peneAcce;o<t._minDeceX?i=t._minDeceX-o:o>t._maxDeceX&&(i=t._maxDeceX-o),n<t._minDeceY?c=t._minDeceY-n:n>t._maxDeceY&&(c=t._maxDeceY-n),0!==i&&(i*t._velocityX<=0?t._velocityX+=i*a:t._velocityX=i*s),0!==c&&(c*t._velocityY<=0?t._velocityY+=c*a:t._velocityY=c*s)}}}]),i});