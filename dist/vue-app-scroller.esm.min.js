/**
* vue-app-scroller v1.0.5
* https://github.com/JooZh/vue-app-scroller
* Released under the MIT License.
*/
var Animate=function(e){var t=Date.now||function(){return+new Date},o={},n=1,r={requestAnimationFrame:function(t){(e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame)(t)},stop:function(e){var t=null!=o[e];return t&&(o[e]=null),t},isRunning:function(e){return null!=o[e]},start:function(e,l,i,a,c){var s=t(),u=s,_=0,h=0,p=n++;if(p%20==0){var f={};for(var m in o)f[m]=!0;o=f}return o[p]=!0,r.requestAnimationFrame(function n(f){var m=!0!==f,v=t();if(!o[p]||l&&!l(p))return o[p]=null,void(i&&i(60-h/((v-s)/1e3),p,!1));if(m)for(var d=Math.round((v-u)/(1e3/60))-1,g=0;g<Math.min(d,4);g++)n(!0),h++;a&&(_=(v-s)/a)>1&&(_=1);var Y=c?c(_):_;!1!==e(Y,v,m)&&1!==_||!m?m&&(u=v,r.requestAnimationFrame(n)):(o[p]=null,i&&i(60-h/((v-s)/1e3),p,1===_||null==a))}),p}};return r}(window);function publicApi(e){return{refresh:function(){e._setDimensions()},publish:function(t,o,n){e._publish(t,o,n)},scrollTo:function(t,o,n){e._scrollTo(t,o,n)},scrollBy:function(t,o,n){e._scrollBy(t,o,n)},stopScroll:function(){e._stopScroll()},getAttr:function(t){if(-1!==["scrollDirection","enableScrollX","enableScrollY","minScrollX","minScrollY","maxScrollX","maxScrollY"].indexOf(t))return e[t];throw new Error('can not get attr name "key" ')},setAttr:function(t,o){if(-1===["enableScrollX","enableScrollY"].indexOf(t))throw new Error('can not set attr name "key" ');e[t]=o}}}var Render=function(e){var t=window,o=document.documentElement.style,n=void 0;t.opera&&"[object Opera]"===Object.prototype.toString.call(opera)?n="presto":"MozAppearance"in o?n="gecko":"WebkitAppearance"in o?n="webkit":"string"==typeof navigator.cpuClass&&(n="trident");var r={trident:"ms",gecko:"Moz",webkit:"Webkit",presto:"O"}[n],l=document.createElement("div"),i=r+"Perspective",a=r+"Transform";return void 0!==l.style[i]?function(t,o){e.style[a]="translate3d("+-t+"px,"+-o+"px,0)"}:void 0!==l.style[a]?function(t,o){e.style[a]="translate("+-t+"px,"+-o+"px)"}:function(t,o){e.style.marginLeft=t?-t+"px":"",e.style.marginTop=o?-o+"px":""}},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Scroller=function(){function e(t,o){_classCallCheck(this,e);var n=this;for(var r in n._NOOP=function(){},n._handles={scroll:[],loading:[]},n.ops={listenScroll:!1,isPullRefresh:!1,isReachBottom:!1,scrollingX:!1,scrollingY:!1,animating:!0,animationDuration:250,mousewheel:!1,paging:!1,snap:!1,snapAlign:"defalut",snapSelect:0,snapListIndex:0,bouncing:!0,speedRatio:1,scrollingComplete:n._NOOP,snapComplete:n._NOOP,peneDece:.07,peneAcce:.08},o)n.ops[r]=o[r];n._initPublicApi(),n._initAttr(t),n._initSnapSize(n.ops.snap),n._initEvent()}return _createClass(e,[{key:"_initSelector",value:function(e){var t=this,o=null;"string"==typeof e?o=document.querySelector(e):"object"===(void 0===e?"undefined":_typeof(e))&&1===e.nodeType&&(o=e);var n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;!n||new n(function(e){var o=e.length-1;e.forEach(function(e,n){if(t.ops.snap)t.refresh();else if(o===n)var r=setTimeout(function(){t.refresh(),clearTimeout(r)},30)})}).observe(o.children[1],{childList:!0,subtree:!0});return o}},{key:"_initAttr",value:function(e){var t=this,o=t._initSelector(e);t._render=Render(o),t._content=o,t._container=o.parentNode,t._animate=Animate,t.scrollDirection="",t._isTracking=!1,t.completeDeceleration=!1,t._isDragging=!1,t._isDecelerating=!1,t._isAnimating=!1,t.enableScrollX=!1,t.enableScrollY=!1,t._refreshActive=!1,t._reachActive=!1,t.snapAlignInit=!1,t._interrupted=!0,t._refreshStartCb=null,t._refreshCancelCb=null,t._refreshActiveCb=null,t.scrollX=0,t.scrollY=0,t.minScrollX=0,t.minScrollY=0,t.maxScrollX=0,t.maxScrollY=0,t._prevScrollX=0,t._prevScrollY=0,t._scheduledX=0,t._scheduledY=0,t._lastTouchX=0,t._lastTouchY=0,t._lastTouchT=null,t._velocityX=0,t._velocityY=0,t._refreshH=0,t._loadingH=0,t._contentW=0,t._contentH=0,t._containerW=0,t._containerH=0,t._snapW=50,t._snapH=50,t._minDeceX=0,t._minDeceY=0,t._maxDeceX=0,t._maxDeceY=0,t._touchArr=null}},{key:"_initEvent",value:function(){var e=this,t=e._container,o=window.Modernizr&&!!window.Modernizr.touch||!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch),n={start:o?"touchstart":"mousedown",move:o?"touchmove":"mousemove",end:o?"touchend":"mouseup"};t.addEventListener(n.start,function(t){t.target.tagName.match(/input|textarea|select/i)||(t.preventDefault(),e.doTouchStart(t.touches,t.timeStamp))},!1),t.addEventListener(n.move,function(t){t.preventDefault(),e.doTouchMove(t.touches,t.timeStamp)},!1),t.addEventListener(n.end,function(t){e.doTouchEnd(t.timeStamp)},!1),e.ops.mousewheel&&t.addEventListener("mousewheel",function(t){e.scrollY=e.scrollY+=t.deltaY,e.scrollY>e.maxScrollY&&(e.scrollY=e.maxScrollY),e.scrollY<0&&(e.scrollY=0),e._publish(e.scrollX,e.scrollY,!0)},!1)}},{key:"_initSnapSize",value:function(e){var t=this;"number"==typeof e?(t._snapW=e,t._snapH=e):Array.isArray(e)&&(t._snapW=e[0],t._snapH=e[1])}},{key:"_setDimensions",value:function(){var e=this;e._containerW=e._container.offsetWidth,e._containerH=e._container.offsetHeight,e._contentW=e._content.offsetWidth,e._contentH=e._content.offsetHeight,e._contentW>e._containerW&&e.ops.scrollingX&&(e.enableScrollX=e.ops.scrollingX),e._contentH>e._containerH&&e.ops.scrollingY&&(e.enableScrollY=e.ops.scrollingY);e.maxScrollY;var t=e._content.children;if(e._refreshH=e.ops.isPullRefresh?t[0].offsetHeight:0,e._loadingH=e.ops.isReachBottom?t[t.length-1].offsetHeight:0,"select"===e.ops.snapAlign){var o=Math.floor(Math.round(e._containerH/e._snapH)/2);e._content.style.padding=o*e._snapH+"px 0",e.snapAlignInit||(e.scrollY=e.minScrollY+e.ops.snapSelect*e._snapH,e.snapAlignInit=!0)}e.maxScrollX=Math.max(e._contentW-e._containerW,0),e.maxScrollY=Math.max(e._contentH-e._containerH,0)-e._refreshH,e._reachActive=!1,e._scrollTo(e.scrollX,e.scrollY,!0)}},{key:"_initPublicApi",value:function(){var e=publicApi(this);for(var t in e)this[t]=e[t]}},{key:"_easeOutCubic",value:function(e){return Math.pow(e-1,3)+1}},{key:"_easeInOutCubic",value:function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)}},{key:"doTouchStart",value:function(e,t){var o=this;o._isTouches(e),o._isTouchesTime(t),o._isTracking=!0,o.stopScroll(),o._lastTouchX=e[0].pageX,o._lastTouchY=e[0].pageY,o._lastTouchT=t}},{key:"doTouchMove",value:function(e,t){var o=this;if(o._isTouches(e),o._isTouchesTime(t),o._isTracking){var n=e[0].pageX,r=e[0].pageY;if(o._doTouchMoveDirection(n,r),o._isDragging){var l=n-o._lastTouchX,i=r-o._lastTouchY;o.enableScrollX&&o._doTouchMoveActive(l,"X"),o.enableScrollY&&o._doTouchMoveActive(i,"Y"),o._touchArr.length>60&&o._touchArr.splice(0,30),o._touchArr.push(o.scrollX,o.scrollY,t),o._publish(o.scrollX,o.scrollY)}else{var a=Math.abs(n-o._lastTouchX),c=Math.abs(r-o._lastTouchY);o._isDragging=a>=5||c>=5,o._isDragging&&(o._interrupted=!1)}o._lastTouchX=n,o._lastTouchY=r,o._lastTouchT=t}}},{key:"doTouchEnd",value:function(e){var t=this;if(t._isTouchesTime(e),t._isTracking){if(t._isTracking=!1,t._isDragging)if(t._isDragging=!1,t.ops.animating&&e-t._lastTouchT<=100)t._doTouchCanDeceleration()?t._refreshActive||t._startDeceleration(e):t._scrollingComplete();else e-t._lastTouchT>100&&t._scrollingComplete();t._isDecelerating||(t._refreshActive&&t._refreshStartCb?(t._publish(t.scrollX,-t._refreshH,!0),t._refreshStartCb&&t._refreshStartCb()):((t._interrupted||t._isDragging)&&t._scrollingComplete(),e-t._lastTouchT>100?(t._scrollTo(t.scrollX,t.scrollY,!0),t._getScrollToValues()):t._startDeceleration(),t._refreshActive&&(t._refreshActive=!1,t._refreshCancelCb&&t._refreshCancelCb()))),t._touchArr.length=0}}},{key:"_isTouches",value:function(e){if(null==e.length)throw new Error("Invalid touch list: "+e)}},{key:"_isTouchesTime",value:function(e){if(e instanceof Date&&(e=e.valueOf()),"number"!=typeof e)throw new Error("Invalid timestamp value: "+e)}},{key:"_doTouchMoveActive",value:function(e,t){var o=this,n="scroll"+t,r="maxScroll"+t;o[n]-=e*o.ops.speedRatio,(o[n]>o[r]||o[n]<0)&&(o.ops.bouncing?(o[n]+=e/1.5*o.ops.speedRatio,"Y"===t&&o._doTouchMovePullRefresh()):o[n]>o[r]?o[n]=o[r]:o[n]=0)}},{key:"_doTouchMovePullRefresh",value:function(){var e=this;e.enableScrollX||null==e._refreshH||(!e._refreshActive&&e.scrollY<=-e._refreshH?(e._refreshActive=!0,e._refreshActiveCb&&e._refreshActiveCb()):e._refreshActive&&e.scrollY>-e._refreshH&&(e._refreshActive=!1,e._refreshCancelCb&&e._refreshCancelCb()))}},{key:"_doTouchMoveDirection",value:function(e,t){var o=this,n=e-o._lastTouchX,r=t-o._lastTouchY;n>0&&Math.abs(n)>Math.abs(r)?o.scrollDirection="right":n<0&&Math.abs(n)>Math.abs(r)?o.scrollDirection="left":r>0&&Math.abs(r)>Math.abs(n)?o.scrollDirection="down":r<0&&Math.abs(r)>Math.abs(n)&&(o.scrollDirection="up")}},{key:"_doTouchCanDeceleration",value:function(){for(var e=this,t=!1,o=e._touchArr.length-1,n=o,r=o;r>0&&e._touchArr[r]>e._lastTouchT-100;r-=3)n=r;if(n!==o){var l=e._touchArr[o]-e._touchArr[n],i=e.scrollX-e._touchArr[n-2],a=e.scrollY-e._touchArr[n-1];e._velocityX=i/l*(1e3/60),e._velocityY=a/l*(1e3/60);var c=e.ops.paging||e.ops.snap?4:1,s=Math.abs(e._velocityX)>c,u=Math.abs(e._velocityY)>c;(s||u)&&(t=!0)}return t}},{key:"activatePullToRefresh",value:function(e,t,o){var n=this;n._refreshStartCb=o,n._refreshActiveCb=e,n._refreshCancelCb=t}},{key:"finishPullToRefresh",value:function(){var e=this;e._refreshActive=!1,e._refreshCancelCb&&e._refreshCancelCb(),e._scrollTo(e.scrollX,e.scrollY,!0)}},{key:"on",value:function(e,t){var o=this;if(o._handles.hasOwnProperty(e)||(o._handles[e]=[]),"function"!=typeof t)throw new Error("Missing callback function");o._handles[e].push(t)}},{key:"emit",value:function(e){for(var t=arguments.length,o=Array(t>1?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];if(!this._handles.hasOwnProperty(e))throw new Error('"'+e+'"Event not registered');this._handles[e].forEach(function(e,t,n){e.apply(null,o)})}},{key:"_stopScroll",value:function(){var e=this;e._interrupted=!0,e._isDecelerating&&(e._animate.stop(e._isDecelerating),e._isDecelerating=!1,e._interrupted=!0),e._isAnimating&&(e._animate.stop(e._isAnimating),e._isAnimating=!1,e._interrupted=!0),e.completeDeceleration=!1,e._touchArr=[]}},{key:"_scrollTo",value:function(e,t,o){var n=this;n._isDecelerating&&(n._animate.stop(n._isDecelerating),n._isDecelerating=!1),n.ops.scrollingX?n.ops.paging?e=Math.round(e/n._containerW)*n._containerW:n.ops.snap&&(e=Math.round(e/n._snapW)*n._snapW):e=n.scrollX,n.ops.scrollingY?n.ops.paging?t=Math.round(t/n._containerH)*n._containerH:n.ops.snap&&(t=Math.round(t/n._snapH)*n._snapH):t=n.scrollY,e=Math.max(Math.min(n.maxScrollX,e),0),t=Math.max(Math.min(n.maxScrollY,t),0),e===n.scrollX&&t===n.scrollY&&(o=!1),n._isTracking||n._publish(e,t,o)}},{key:"_scrollToElement",value:function(e,t,o){}},{key:"_scrollBy",value:function(e,t,o){var n=this,r=n._isAnimating?n._scheduledX:n.scrollX,l=n._isAnimating?n._scheduledY:n.scrollY;n._scrollTo(r+(e||0),l+(t||0),o)}},{key:"_publish",value:function(e,t,o){var n=this,r=n._isAnimating;if(r&&(n._animate.stop(r),n._isAnimating=!1,n._interrupted=!0),o&&n.ops.animating){n._scheduledX=e,n._scheduledY=t;var l=n.scrollX,i=n.scrollY,a=e-l,c=t-i,s=r?n._easeOutCubic:n._easeInOutCubic;n._isAnimating=n._animate.start(function(e,t,o){o&&(n.scrollX=l+a*e,n.scrollY=i+c*e,n._render&&n._render(n.scrollX,n.scrollY))},function(e){return n._isAnimating===e},function(e,t,o){t===n._isAnimating&&(n._isAnimating=!1),(n.completeDeceleration||o)&&(n._scrollingComplete(),n._snapComplete())},n.ops.animationDuration,s)}else n._scheduledX=n.scrollX=e,n._scheduledY=n.scrollY=t,n._render&&n._render(e,t);if(n.ops.isReachBottom&&!n._reachActive){var u=Number(n.scrollY.toFixed()),_=n.maxScrollY-n._loadingH;u>_&&_>0&&(n.emit("loading",{hasMore:!0}),n._reachActive=!0)}if(n.ops.listenScroll){var h=n._prevScrollX.toFixed()!==n.scrollX.toFixed(),p=n._prevScrollY.toFixed()!==n.scrollY.toFixed();(h||p)&&n.emit("scroll",{x:Math.floor(n.scrollX),y:Math.floor(n.scrollY)})}}},{key:"_scrollingComplete",value:function(){this.ops.scrollingComplete()}},{key:"_snapComplete",value:function(){var e=this;"select"===e.ops.snapAlign&&e.ops.snapComplete(e._getSnapValue())}},{key:"_getSnapValue",value:function(){var e=this,t=Math.abs(e.minScrollY),o=(e.scrollY<0?t-Math.abs(e.scrollY):t+Math.abs(e.scrollY))/e._snapH;return{listIndex:e.ops.snapListIndex,selectIndex:Math.floor(o)}}},{key:"_getScrollToValues",value:function(){var e=this,t=setInterval(function(){var o=e._prevScrollX.toFixed()!==e.scrollX.toFixed(),n=e._prevScrollY.toFixed()!==e.scrollY.toFixed();if(o||n)e.emit("scroll",{x:Math.floor(e.scrollX),y:Math.floor(e.scrollY)});else var r=setTimeout(function(){var o=e.scrollX,n=e.scrollY;0===e.scrollY&&(n=0),0===e.scrollX&&(o=0),e.scrollY===e.maxScrollY&&(n=e.maxScrollY),e.scrollX===e.maxScrollX&&(o=e.maxScrollX),e.emit("scroll",{x:Math.floor(o),y:Math.floor(n)}),clearInterval(t),clearTimeout(r)},50)},30)}},{key:"_startDeceleration",value:function(){var e=this;if(e.ops.paging){var t=Math.max(Math.min(e.scrollX,e.maxScrollX),0),o=Math.max(Math.min(e.scrollY,e.maxScrollY),0);e._minDeceX=Math.floor(t/e._containerW)*e._containerW,e._minDeceY=Math.floor(o/e._containerH)*e._containerH,e._maxDeceX=Math.ceil(t/e._containerW)*e._containerW,e._maxDeceY=Math.ceil(o/e._containerH)*e._containerH}else e._minDeceX=0,e._minDeceY=0,e._maxDeceX=e.maxScrollX,e._maxDeceY=e.maxScrollY;var n=e.ops.snap?2:.001;e._isDecelerating=e._animate.start(function(t,o,n){e._stepThroughDeceleration(n)},function(){var t=Math.abs(e._velocityX)>=n||Math.abs(e._velocityY)>=n;return t||(e.completeDeceleration=!0),t},function(t,o,n){e._isDecelerating=!1,e.completeDeceleration&&e._scrollingComplete(),e._scrollTo(e.scrollX,e.scrollY,e.ops.snap)})}},{key:"_stepThroughDeceleration",value:function(e){var t=this,o=t.scrollX+t._velocityX,n=t.scrollY+t._velocityY;if(!t.ops.bouncing){var r=Math.max(Math.min(t._maxDeceX,o),t._minDeceX);r!==o&&(o=r,t._velocityX=0);var l=Math.max(Math.min(t._maxDeceY,n),t._minDeceY);l!==n&&(n=l,t._velocityY=0)}if(t._prevScrollX=t.scrollX,t._prevScrollY=t.scrollY,e?t._publish(o,n):(t.scrollX=o,t.scrollY=n),!t.ops.paging){t._velocityX*=.97,t._velocityY*=.97}if(t.ops.bouncing){var i=0,a=0,c=t.ops.peneDece,s=t.ops.peneAcce;o<t._minDeceX?i=t._minDeceX-o:o>t._maxDeceX&&(i=t._maxDeceX-o),n<t._minDeceY?a=t._minDeceY-n:n>t._maxDeceY&&(a=t._maxDeceY-n),0!==i&&(i*t._velocityX<=0?t._velocityX+=i*c:t._velocityX=i*s),0!==a&&(a*t._velocityY<=0?t._velocityY+=a*c:t._velocityY=a*s)}}}]),e}();export default Scroller;